<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <!-- Bootstrap -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
     <link rel="stylesheet" href="../offlines/bootstrap.min.css">
     <!-- Icon -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
     <link rel="stylesheet" href="../offlines/fontawesome-free-6.4.2-web/css/all.css">
     <link rel="stylesheet" href="../offlines/tabler-icons/webfont/tabler-icons.min.css">

     <link rel="stylesheet" href="../student/dashboard.css">
     <link rel="stylesheet" href="../responsiveness.css">
     <link rel="stylesheet" href="../styles.css">
     <link rel="stylesheet" href="loading.css">

     <link rel="icon" href="../images/single.png">
     <title>Tution Fees List</title>
</head>
<body style="position: relative;"  class="collapsed">
     <!-- Loading display -->
     <!-- <div id="loading" class="loading">
          <div class="loader">
               <div class="box1"></div>
               <div class="box2"></div>
               <div class="box3"></div>
          </div>
     </div> -->

     <main id="content" class="main-content hidde row general">
     
          <div class="col-2 p-0" id="side">
               <nav class="sidebar">
                    <div class="sidebar-top-wrapper">
                         <div class="sidebar-top mx-auto">
                              <a href="#" class="logo_wrapper">
                                   <img src="../images/multiple.png" alt="logo" class="logo-small logo-small1">
                                   <img src="../images/single.png" alt="logo" class="logo-small logo-small2">
                              </a>
                         </div>
                         <button class="expand-btn" type="button"><i class="fa fa-expand"></i></button>
                    </div>
                    <div class="sidebar-links-wrapper">
                         <div class="sidebar-links">
                              <ul>
                                   <li>
                                        <a href="index" class="main-item" title="Dashboard">
                                             <i class="fa-solid fa-tachograph-digital"></i>
                                             <span class="link hide">Overview</span>
                                        </a>
                                   </li>
                                   <li>
                                        <a href="allStudents" title="All Students" class="main-item">
                                             <i class="fa-solid fa-building-columns"></i>
                                             <span class="link hide">All Students</span>
                                        </a>
                                   </li>
                                   <li>
                                        <a href="CreateFaculty" title="Create Faculty" class="main-item">
                                             <i class="fa fa-clipboard"></i>
                                             <span class="link hide">Create Faculty</span>
                                        </a>
                                   </li>
                                   <li>
                                        <a href="fees" title="Tution Fees" class="main-item active">
                                             <i class="fa-solid fa-money-check-dollar"></i>
                                             <span class="link hide">Tution Fees</span>
                                        </a>
                                   </li>
                                   <li>
                                        <a href="event" title="Event" class="main-item">
                                             <i class="fa fa-calendar"></i>
                                             <span class="link hide">Event</span>
                                        </a>
                                   </li>
                              </ul>
                         </div>
                    </div>
                    <div class="sidebar_bottom">
                         <div class="sidebar_profile">
                              <div class="avatar_wrapper">
                                   <img src="../images/single.png" alt="avatar" class="avatar bg-light">
                              </div>
                              <div class="avatar_name hide">
                                   <div class="user-name">Administrator</div>
                                   <div class="email">admin@mail.com</div>
                              </div>
                         </div>
                         <!-- Logout icon -->
                         <a title="Logout" class="logout tooltips main-item" onclick="logout()">
                              <i class="fa fa-sign-out-alt"></i>
                              <span class="expand-icon">Logout</span>
                         </a>
                    </div>
               </nav>
          </div>

          <div class="col-10" id="main">
               <section class="main-content ms-auto pb-5">
                    <div class="row align-items-center">
                         <div class="col-12">
                              <div class="in-new-prod-cont p-3">
                                   <h4 class="p-0 m-0">Paid Students</h4>
                              </div>
                         </div>

                         <!-- search bar and filter button -->
                         <div class="row align-items-center my-3 gap-3 gap-md-0 justify-content-between">
                              <div class="col-md-6 col-12">
                                   <div class="input-group">
                                        <input type="text" class="form-control" id="inputs" placeholder="Search Student">
                                        <button class="btn btn-outline-secondary" type="button" id="button-addon2"><i class="fa fa-search"></i></button>
                                   </div>
                              </div>
                              <div class="col-lg-4 col-md-6 col-12 d-flex gap-3 align-items-md-end align-items-center justify-content-md-end justify-content-center">
                                   <button class="btn btn-primary refresh"><i class="fa-solid me-2 fa-arrows-rotate"></i> Refresh</button>
                                   <button class="btn btn-primary filterBtn" data-bs-toggle="modal" data-bs-target="#filterModal"><i class="fa me-2 fa-filter"></i> Filter</button>
                              </div>
                         </div>
                         
                         <!-- table -->
                         <div class="row my-3">
                              <div class="col-12">
                                   <div class="table-responsive">
                                        <table class="table">
                                             <thead>
                                                  <tr>
                                                       <th scope="col">Matric Number</th>
                                                       <th scope="col">Fullname</th>
                                                       <th scope="col">Faculty</th>
                                                       <th scope="col">Admission Type</th>
                                                       <th scope="col">Payment Type</th>
                                                       <th scope="col">Transaction Refrence</th>
                                                       <th scope="col">Year of Admission</th>
                                                  </tr>
                                             </thead>
                                             <tbody id="datalist">
                                                  <!-- Data will be appended here -->
                                             </tbody>
                                        </table>
                                   </div>
                              </div>
                              </div>
                         </div>
               </section>
          </div>

     </main>

    <!-- <script src="loading.js"></script> -->
    <script src="../student/sidebar.js"></script>
    <script src="../student/dashboard.js"></script>
     <!-- Font Awsome Link -->
     <script src="https://kit.fontawesome.com/2a49fbdbb8.js" crossorigin="anonymous"></script>
     <!-- Bootstrap Js -->
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
     <script src="../bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
     <!-- AXIOS JS -->
     <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
     <script>
          document.addEventListener('DOMContentLoaded', function() {
               axios.get("/api/v1/auth/users")
               .then((response) => {
                   let users = response.data;
                   axios.get("/api/v1/transaction/getAll")
                   .then((response) => {
                       let transactions = response.data.transactions;
                       appendUserDetails(transactions, users);
                   })
                   .catch((error) => {
                       console.log(error);
                   });
               })
               .catch((error) => {
                   console.log(error);
               });
           });
   
           function appendUserDetails(transactions, users) {
               const dataList = document.getElementById('datalist');
               dataList.innerHTML = '';
   
               transactions.forEach(transaction => {
                   const user = users.find(user => user._id === transaction.userId);
                   if (user) {
                       const row = document.createElement('tr');
                       row.innerHTML = `
                           <td>${user.matricNumber}</td>
                           <td>${user.firstName} ${user.lastName}</td>
                           <td>${transaction.studyType}</td>
                           <td>${transaction.transType}</td>
                           <td>${transaction.transRef}</td>
                           <td>${transaction.transStatus}</td>
                           <td>${transaction.year}</td>
                       `;
                       dataList.appendChild(row);
                   }
               });
           }
     </script>
</body>
</html>